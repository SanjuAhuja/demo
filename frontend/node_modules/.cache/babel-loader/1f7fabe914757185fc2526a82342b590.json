{"ast":null,"code":"import _objectSpread from\"C:/Users/DELL/Desktop/sample/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/DELL/Desktop/sample/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{Link}from\"react-router-dom\";import{createOrder}from\"../actions/orderActions\";import CheckoutSteps from\"../components/CheckoutSteps\";import{ORDER_CREATE_RESET}from\"../constants/orderContants\";import LoadingBox from'../components/LoadingBox';import MessageBox from'../components/MessageBox';import axios from\"axios\";import Razorpay from'razorpay';import{useHistory}from\"react-router-dom\";import{set}from\"mongoose\";import{Card}from\"react-bootstrap\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function PlaceOrderScreen(props){var history=useHistory();var _useState=useState(),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var cart=useSelector(function(state){return state.cart;});if(!cart.paymentMethod){props.history.push('/payment');}var orderCreate=useSelector(function(state){return state.orderCreate;});var loading=orderCreate.loading,success=orderCreate.success,error=orderCreate.error,order=orderCreate.order;var toPrice=function toPrice(num){return Number(num.toFixed(2));};cart.itemPrice=toPrice(cart.cartItems.reduce(function(a,c){return a+c.qty*c.price;},0));cart.shippingPrice=cart.itemPrice>100?toPrice(0):toPrice(1);cart.taxPrice=toPrice(0.15*cart.itemPrice);cart.totalPrice=cart.itemPrice+cart.shippingPrice+cart.taxPrice;cart.fullName=cart.shippingAddress.fullName;cart.address=cart.shippingAddress.address;cart.city=cart.shippingAddress.city;cart.postalCode=cart.shippingAddress.postalCode;cart.country=cart.shippingAddress.country;var dispatch=useDispatch();var paymentHandler=function paymentHandler(e){dispatch(createOrder(_objectSpread(_objectSpread({},cart),{},{orderItems:cart.cartItems,shippingAddress:cart.shippingAddress})));};useEffect(function(){if(success){props.history.push(\"/order/\".concat(order._id));dispatch({type:ORDER_CREATE_RESET});}},[dispatch,order,props.history,success]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CheckoutSteps,{step1:true,step2:true,step3:true,step4:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"row top\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-2\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-body\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Shipping\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",cart.shippingAddress.fullName,\" \",/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"strong\",{children:\"Address:\"}),\" \",cart.shippingAddress.address,\",\",cart.shippingAddress.city,\",  \",cart.shippingAddress.postalCode,\",\",cart.shippingAddress.country]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card card-body\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Order Items\"}),/*#__PURE__*/_jsx(\"ul\",{children:cart.cartItems.map(function(item){return/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name,className:\"small\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"min-30\",children:/*#__PURE__*/_jsx(Link,{to:\"/product/\".concat(item.product),children:item.name})}),/*#__PURE__*/_jsxs(\"div\",{children:[item.qty,\" x $\",item.price,\" = $\",item.qty*item.price]})]})},item.product);})})]})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"col-1\",children:/*#__PURE__*/_jsx(\"div\",{className:\"card card-body\",children:/*#__PURE__*/_jsxs(\"ul\",{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"h2\",{children:\"Order Summary\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Items\"}),/*#__PURE__*/_jsxs(\"div\",{children:[\"$\",cart.itemPrice.toFixed(2)]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Shipping\"}),/*#__PURE__*/_jsxs(\"div\",{children:[\"$\",cart.shippingPrice.toFixed(2)]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:\"Tax\"}),/*#__PURE__*/_jsxs(\"div\",{children:[\"$\",cart.taxPrice.toFixed(2)]})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"strong\",{children:\" Order Total\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"strong\",{children:[\"$\",cart.totalPrice.toFixed(2)]})})]})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:paymentHandler,className:\"course-payment-button\",children:\"Place Order\"})}),loading&&/*#__PURE__*/_jsx(LoadingBox,{}),error&&/*#__PURE__*/_jsx(MessageBox,{variant:\"danger\",children:error})]})})})]})]});}","map":{"version":3,"sources":["C:/Users/DELL/Desktop/sample/frontend/src/screens/PlaceOrderScreen.js"],"names":["React","useEffect","useState","useDispatch","useSelector","Link","createOrder","CheckoutSteps","ORDER_CREATE_RESET","LoadingBox","MessageBox","axios","Razorpay","useHistory","set","Card","PlaceOrderScreen","props","history","formData","setFormData","cart","state","paymentMethod","push","orderCreate","loading","success","error","order","toPrice","num","Number","toFixed","itemPrice","cartItems","reduce","a","c","qty","price","shippingPrice","taxPrice","totalPrice","fullName","shippingAddress","address","city","postalCode","country","dispatch","paymentHandler","e","orderItems","_id","type","map","item","image","name","product"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { createOrder } from \"../actions/orderActions\";\r\nimport CheckoutSteps from \"../components/CheckoutSteps\";\r\nimport { ORDER_CREATE_RESET } from \"../constants/orderContants\";\r\nimport LoadingBox from '../components/LoadingBox';\r\nimport MessageBox from '../components/MessageBox';\r\nimport axios from \"axios\";\r\nimport Razorpay from 'razorpay';\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { set } from \"mongoose\";\r\nimport { Card } from \"react-bootstrap\";\r\n\r\nexport default function PlaceOrderScreen(props) {\r\n    const history = useHistory();\r\n    const [formData, setFormData] = useState();\r\n    const cart = useSelector((state) => state.cart);\r\n    if(!cart.paymentMethod) {\r\n        props.history.push('/payment');\r\n    }\r\n    const orderCreate = useSelector((state) => state.orderCreate);\r\n    const { loading, success, error, order } = orderCreate;\r\n    const toPrice = (num) => Number(num.toFixed(2));\r\n    cart.itemPrice = toPrice(cart.cartItems.reduce((a, c) => a + c.qty * c.price, 0)\r\n    );\r\n    cart.shippingPrice = cart.itemPrice > 100 ? toPrice(0) : toPrice(1);\r\n    cart.taxPrice = toPrice(0.15 * cart.itemPrice);\r\n    cart.totalPrice = cart.itemPrice + cart.shippingPrice + cart.taxPrice;\r\n    cart.fullName = cart.shippingAddress.fullName;\r\n    cart.address =  cart.shippingAddress.address;\r\n    cart.city = cart.shippingAddress.city;\r\n    cart.postalCode = cart.shippingAddress.postalCode;\r\n    cart.country = cart.shippingAddress.country;\r\n  \r\n    const dispatch = useDispatch();\r\n\r\n    const paymentHandler = (e) => {\r\n        dispatch(createOrder({ ...cart, orderItems: cart.cartItems, shippingAddress: cart.shippingAddress }));\r\n     };\r\n\r\n    useEffect(() => {\r\n        if(success)\r\n        {\r\n            props.history.push(`/order/${order._id}`);\r\n            dispatch({ type: ORDER_CREATE_RESET });\r\n        }\r\n    }, [dispatch, order, props.history, success]);\r\n    return(\r\n        <div>\r\n            <CheckoutSteps step1 step2 step3 step4></CheckoutSteps>\r\n            <div className=\"row top\">\r\n                <div className=\"col-2\">\r\n                    <ul>\r\n                        <li>\r\n                            <div className=\"card card-body\">\r\n                                <h2>Shipping</h2>\r\n                                <p>\r\n                                    <strong>Name:</strong> {cart.shippingAddress.fullName} <br />\r\n                                    <strong>Address:</strong> {cart.shippingAddress.address},\r\n                                    {cart.shippingAddress.city},  {cart.shippingAddress.postalCode},\r\n                                    {cart.shippingAddress.country}\r\n                                </p>\r\n                            </div>\r\n                        </li>\r\n                        \r\n                        <li>\r\n                        <div className=\"card card-body\">\r\n                                <h2>Order Items</h2>\r\n                                <ul>\r\n                            {\r\n                                cart.cartItems.map((item) => (\r\n                                    <li key={item.product}>\r\n                                        <div className=\"row\">\r\n                                            <div>\r\n                                                <img src={item.image} alt={item.name} className=\"small\"></img>\r\n                                            </div>\r\n                                            <div className=\"min-30\">\r\n                                                <Link to={`/product/${item.product}`}>{item.name}</Link>\r\n                                             </div>\r\n                                             \r\n                                             <div>\r\n                                                 {item.qty} x ${item.price} = ${item.qty * item.price}\r\n                                             </div>\r\n                                           \r\n                                        </div>\r\n                                    </li>\r\n                                ))\r\n                            }\r\n                        </ul>\r\n                            </div>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                <div className=\"col-1\">\r\n                        <div className=\"card card-body\">\r\n                            <ul>\r\n                                <li>\r\n                                    <h2>Order Summary</h2>\r\n                                </li>\r\n                                <li>\r\n                                    <div className=\"row\">\r\n                                        <div>Items</div>\r\n                                        <div>${cart.itemPrice.toFixed(2)}</div>\r\n                                    </div>\r\n                                </li>\r\n                                <li>\r\n                                    <div className=\"row\">\r\n                                        <div>Shipping</div>\r\n                                        <div>${cart.shippingPrice.toFixed(2)}</div>\r\n                                    </div>\r\n                                </li>\r\n                                <li>\r\n                                    <div className=\"row\">\r\n                                        <div>Tax</div>\r\n                                        <div>${cart.taxPrice.toFixed(2)}</div>\r\n                                    </div>\r\n                                </li>\r\n                                <li>\r\n                                    <div className=\"row\">\r\n                                        <div><strong> Order Total</strong></div>\r\n                                        <div>\r\n                                            <strong>\r\n                                                ${cart.totalPrice.toFixed(2)}\r\n                                            </strong>\r\n                                        </div>\r\n                                    </div>\r\n                                </li>\r\n                                <li>\r\n                                    <button \r\n                                        type=\"submit\" \r\n                                        onClick={paymentHandler} \r\n                                        className=\"course-payment-button\"\r\n                                       >\r\n                                        Place Order\r\n                                    </button>\r\n                                </li>\r\n                                {loading && <LoadingBox></LoadingBox>}\r\n                                {error && <MessageBox variant=\"danger\">{error}</MessageBox>}\r\n                            </ul>\r\n                        </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}